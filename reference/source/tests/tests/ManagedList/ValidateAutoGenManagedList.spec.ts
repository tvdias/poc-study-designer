import { expect, mergeTests } from '@playwright/test';
import { logintest } from '../Fixture/LoginFixture';
import { createproject } from '../Fixture/CreateProjectWithAutoGenML';
import { ManagedListService } from '../../services/ManagedListService';
import { TestData as MLTestData } from '../../Test Data/ManagedListData.json';

// Using a LoginFixture and CreateProjectWithAutoGenML to handle setup and teardown for all test cases:
// 1. Login the application with CS user
// 2. Create the project and add a question before each test execution.
// 3. Delete the project after the each test case execution


// Merges the results of the login test and the create a Project test into a single combined test execution.
const test = mergeTests(logintest, createproject);



test("[2545902] Verify that the auto generated ML name is not editable from the project by CS user", { tag: ['@Regression', '@ManagedList'] }, async ({ page, browser, loginPage, projectName, guid }) => {

    test.info().annotations.push({ type: 'TestCaseId', description: '2545902' });

    const managedListService = new ManagedListService(page);
    const managedListName = MLTestData.AutoGen_MLName;


    await test.step('Create and Validate the Manage list from Project', async () => {
        await managedListService.clickonSaveRecord();
        await managedListService.selectManagedListTab();
        await managedListService.clickonSaveRecord();
        await managedListService.verifyAddedManagedListDetails(managedListName, MLTestData.IsAutoGenerated_Yes);
    });
    await test.step('Open the Manage list from the grid which is imported from QB ', async () => {
        await managedListService.clickOnManagedList(managedListName);
    });
    await test.step('Check if ML Name text field is locked and disabled', async () => {
        await managedListService.verifyMLNameTextFieldIsEditable(false);
    });
});